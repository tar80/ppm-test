String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/,"")});var e,validArgs=function(){for(var e=[],t=PPx.Arguments;!t.atEnd();t.moveNext())e.push(t.value);return e},safeArgs=function(){for(var e=[],t=validArgs(),n=0,r=arguments.length;n<r;n++)e.push(_valueConverter(n<0||arguments.length<=n?undefined:arguments[n],t[n]));return e},_valueConverter=function(e,t){if(null==t||""===t)return null!=e?e:undefined;switch(typeof e){case"number":var n=Number(t);return Number.isNaN(n)?e:n;case"boolean":return null!=t&&"false"!==t&&"0"!==t;default:return t}},t={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",encode:"utf16le",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},useLanguage=function(){var e=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===e||"ja"===e?e:t.language},n={tempKey:"K_ppmTemp",tempMenu:"M_ppmTemp",lfDset:"ppm_lfdset",virtualEntry:"ppm_ve"},isEmptyStr=function(e){return""===e},isEmptyObj=function(e){if(e===undefined)return!1;if(null===e)return!0;for(var t in e)return!1;return!0};Array.prototype.removeEmpty||(Array.prototype.removeEmpty=function(){for(var e=[],t=0,n=this.length;t<n;t++){var r=this[t];null==r||""===r||r instanceof Array&&0===r.length||r instanceof Object&&isEmptyObj(r)||e.push(r)}return e}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new Error('Array.indexOf: "this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0===i)return-1;var o=null!=t?t:0;if(Math.abs(o)===Infinity&&(o=0),o>=i)return-1;for(n=Math.max(o>=0?o:i-Math.abs(o),0);n<i;){if(n in r&&r[n]===e)return n;n++}return-1}),e=PPx.Extract("%*getcust(S_ppm#global:git)"),isEmptyStr(e);var r=["sjis","euc","utf8","utf8bom","unicode","utf16","unicodeb","utf16be","unicodebom","unicodebbom","ibm","us","ansi","latin1","system"];PPx.CreateObject("Scripting.FileSystemObject");var i=["query","save","silent","clear","modify","write","readonly"],_getEditmode=function(e,t,n,r){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),void 0===r&&(r=""),t=-1!==i.indexOf(t)?"-modify:"+t:"",isEmptyStr(n)||(n=_getEncode(n)),isEmptyStr(r)||(r=-1!==["crlf","cr","lf"].indexOf(r)?"-"+r:"-crlf");var o=[e,n,r,t].removeEmpty();return o.length>0?"*editmode "+o.join(" "):""},_getEncode=function(e){return~e.indexOf("codepage:")||(e=-1!==r.indexOf(e)?e:"utf8bom"),"-"+e},runPPe=function(e){var t=e.wait,n=void 0!==t&&t,r=e.path,i=void 0===r?"":r,o=e.encode,u=void 0===o?"utf8bom":o,a=e.linefeed,f=void 0===a?"crlf":a,c=e.title,l=e.tab,p=void 0===l?8:l,s=e.history,d=e.modify,m=e.saveenc,v=e.savelf,x=e.k,y=void 0===x?"":x,P=n?"*edit":"*ppe",h=i?"-new":"",g=_getEncode(u),E=-1!==["crlf","cr","lf"].indexOf(f)?"-"+f:"-crlf",b="-tab:"+p,A=[c=c?"*setcaption "+c:"",_getEditmode(s,d,m,v),y].removeEmpty();A.length>0&&(y="-k %("+A.join("%:")+"%)");var w=[P,h,g,E,b,i,y].removeEmpty().join(" ");PPx.Execute(w)},o="ppm-test",u="Highlight Hex",a=PPx.ScriptName,main=function(){var e=safeArgs(!1,!1),t=e[0];e[1]?procEdit():procShow(t)},_foreachEntry=function(e){var t=PPx.Extract("%*getcust(C_eInfo)").split(","),n=0;do{e(t,n)}while(++n<=7);return t},_loadPPe=function(e){var t="*windowsize %N.,200,300",r="*fitwindow %NC,%N.,5",i="*mapkey use,"+n.tempKey,c='*insert "'+e.join("%bn")+'"';PPx.Execute("*setcust "+n.tempKey+':^S,%(%"'+o+'"%Q"'+f.save+'"%:*script '+a+",1,1%)"),runPPe({wait:!0,title:u,history:"",modify:"silent",k:t+"%:"+r+"%:"+i+"%:"+c}),PPx.Execute('*deletecust "'+n.tempKey+'"')},procShow=function(e){PPx.Execute('%KC"@F5"%:*wait 0,2');var t=e?0:PPx.EntryIndex,n=[];_foreachEntry((function(e,r){var i=e[r+13].trim(),o=r+1,u=t+r,a="Highlight:"+o+" "+i;n.push(i),PPx.EntryInsert(u,a),PPx.Entry.Item(u).Highlight=o})),e&&"0"===PPx.Extract('%*findwindowtitle("'+u+'")')&&_loadPPe(n)},procEdit=function(){"1"===PPx.Extract("*if %N==%NC%:1")&&PPx.Quit(1);var e=PPx.Extract("%*edittext()").split(t.nlcode),n=/^(h\w{6}|_(BLA|BLU|RED|MAG|GRE|CYA|BRO|WHI|DBLA|DBLU|DRED|DMAG|DGRE|DCYA|DBRO|DWHI|MGRE|SBLU|CREM|GRAY))/i,r=_foreachEntry((function(t,r){var i=n.test(e[r])?e[r].toUpperCase():"_AUTO";t[r+13]=i.trim()}));PPx.Execute("*customize C_eInfo="+r.join(",")),PPx.Execute("*execute C,*script "+a)},f={en:{save:"Save/reload highlight information being edited"},ja:{save:"編集中のハイライト情報を保存・再読み込みします"}}[useLanguage()];main();
